<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>冒險者公會</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <main id="app-content" class="page"></main>

    <div id="page-templates" style="display: none;">

        <div id="page-home">
            <div class="news-header">
                <div class="news-header-decoration"></div>
                <h1>最新情報</h1>
            </div>
            <div id="news-filter-container">
                <p>讀取中...</p>
            </div>
            <div id="news-list-container">
                <p>正在載入最新情報...</p>
            </div>
        </div>

        <div id="page-games">
            <div id="filter-controls">
                <input type="search" id="keyword-search" placeholder="搜尋關鍵字 (遊戲名稱、描述)...">
                <div id="tag-filter-container"><div id="tag-filters" class="filter-group"></div></div>
                <button id="clear-filters">清除所有篩選</button>
            </div>
            <div id="game-list-container"><p>正在載入桌遊資料...</p></div>
        </div>
        
        <div id="page-game-details">
            </div>

        <div id="page-profile">
             <h1>冒險者資料</h1>
             <div id="profile-info" style="text-align: center; margin-top: 20px;">
                 <img id="profile-picture" src="" alt="Profile Picture" style="width: 100px; height: 100px; border-radius: 50%;">
                 <h2 id="display-name" h3 id="(profile-nickname)" style="margin-top: 10px;"></h2>
                 <p id="status-message" style="color: #aaa;"></p>
             </div>
             <div id="qrcode-container" style="background-color: white; padding: 20px; margin: 25px auto; width: 200px; height: 200px;">
                 <div id="qrcode" style="width:200px; height:200px;"></div>
             </div>
             <div style="margin-top: 10px;">
                 <p>職業：<span id="user-class">--</span></p> 
                 <p>等級：<span id="user-level">--</span></p>
                 <p>經驗值：<span id="user-exp">-- / --- </span></p>
             </div>
             <div id="my-bookings-section">
                <h2>我預約的冒險旅程</h2>
                <div id="my-bookings-container"><p>正在查詢您的預約紀錄...</p></div>
             </div>
             <div class="profile-actions">
                <button id="edit-profile-btn" class="cta-button">完善冒險者登錄</button>
             </div>
             <div id="profile-modal" class="modal-overlay" style="display: none;">
                <div class="modal-content">
                    <button class="modal-close-btn">&times;</button>
                    <h2>冒險者登錄</h2>
                    <p>填寫您的資料，讓我們更認識你！</p>
                    <form id="profile-form">
                        <div class="input-group"><label for="profile-nickname">暱稱</label><input type="text" id="profile-nickname" required></div>
                        <div class="input-group"><label for="profile-phone">聯絡電話</label><input type="tel" id="profile-phone" maxlength="10" required></div>
                        <div class="input-group">
                            <label for="profile-games">偏好的遊戲類型</label>
                            <select id="profile-games">
                                <option value="策略">策略</option><option value="派對">派對</option><option value="家庭">家庭</option>
                                <option value="陣營">陣營</option><option value="其他">其他 (請手動輸入)</option>
                            </select>
                            <input type="text" id="profile-games-other" placeholder="請輸入其他偏好類型" style="display: none; margin-top: 10px;">
                        </div>
                        <button type="submit" class="cta-button">儲存資料</button>
                    </form>
                    <p id="profile-form-status" class="form-status"></p>
                </div>
            </div>
        </div>

        <div id="page-booking">
            <div id="booking-wizard-container">
                <div id="step-preference" class="booking-step active">
                    <div class="booking-header"><h1>場地預約</h1><p class="booking-subtitle">冒險從你預約的這天開始</p></div>
                    <div class="preference-options">
                        <button class="preference-btn" data-preference="一次性"><h3>🎟️ 一次性入場</h3><p><strong>平日 $150 / 假日 $250</strong><br>適合長時間暢玩</p></button>
                    </div>
                    <div class="discount-highlight"><p>✨ <strong>提前三日預約，享每人現折 $20 優惠！</strong></p></div>
                    <div class="booking-notice"><p><strong>請注意：</strong>包廂及當日預約請透過 LINE 官方帳號或電話聯繫我們。</p></div>
                </div>
                <div id="step-date-and-slots" class="booking-step">
                    <button class="back-button">← 返回</button>
                    <h2>選擇預約日期與時段</h2>
                    <div class="calendar-and-slots-container">
                        <div id="booking-datepicker-container"></div>
                        <div id="booking-slots-wrapper">
                             <p id="slots-placeholder">請先從上方選擇日期</p>
                             <div id="booking-slots-container"></div>
                        </div>
                    </div>
                </div>
                <div id="step-contact" class="booking-step">
                    <button class="back-button">← 返回</button>
                    <h2>填寫預約資訊</h2>
                    <div class="input-group"><label>您選擇的場次：</label><div id="contact-summary"></div></div>
                    <div class="input-group"><label for="booking-people">預約總人數：</label><input type="number" id="booking-people" min="1" max="20" placeholder="請輸入總人數"></div>
                    <div class="input-group"><label for="contact-name">預約姓名：</label><input type="text" id="contact-name" placeholder="請輸入您的姓名"></div>
                    <div class="input-group"><label for="contact-phone">聯絡電話：</label><input type="tel" id="contact-phone" placeholder="請輸入您的手機號碼" maxlength="10"></div>
                    <button id="to-summary-btn" class="cta-button">下一步：確認資訊</button>
                </div>
                <div id="step-summary" class="booking-step">
                    <button class="back-button">← 返回</button>
                    <h2>確認預約內容</h2>
                    <div id="booking-summary-card" class="summary-card"></div>
                    <button id="confirm-booking-btn" class="cta-button">確認送出</button>
                </div>
                <div id="step-result" class="booking-step">
                    <div id="booking-result-content"></div>
                </div>
            </div>
        </div>
        
        <div id="page-info">
            <h1>店家資訊</h1>
            <div id="store-info-container">
                <div class="info-section">
                    <h2 id="store-name">讀取中...</h2>
                    <p><strong>地址：</strong><span id="store-address">讀取中...</span></p>
                    <p><strong>電話：</strong><span id="store-phone">讀取中...</span></p>
                </div>
                <div class="info-section">
                    <h2>營業時間</h2>
                    <p><pre id="store-hours">讀取中...</pre></p>
                </div>
                <div class="info-section">
                    <h2>公會介紹</h2>
                    <p id="store-description">讀取中...</p>
                </div>
            </div>
        </div>
    </div>

    <nav id="tab-bar">
        <button class="tab-button active" data-target="page-home">最新情報</button>
        <button class="tab-button" data-target="page-games">桌遊圖鑑</button>
        <button class="tab-button" data-target="page-profile">冒險者資料</button>
        <button class="tab-button" data-target="page-booking">場地預約</button>
        <button class="tab-button" data-target="page-info">店家資訊</button>
    </nav>

    <script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
    <script src="https://npmcdn.com/flatpickr/dist/l10n/zh-tw.js"></script>
    <script src="script.js"></script>
</body>
</html>